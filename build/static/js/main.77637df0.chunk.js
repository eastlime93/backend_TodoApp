(this.webpackJsonptodolist=this.webpackJsonptodolist||[]).push([[0],{99:function(e,t,c){"use strict";c.r(t);var a=c(0),s=c.n(a),r=c(21),n=c.n(r),o=c(6),i=c(40);function d(e,t){switch(t.type){case"LOGIN":case"REGISTER":return{username:t.username,access_token:t.access_token};case"LOGOUT":return{username:void 0,access_token:void 0};default:return e}}function j(e,t){switch(t.type){case"CREATE_TODO":return[{title:t.title,description:t.description,dateCreated:t.dateCreated,complete:t.complete,dateCompleted:t.dateCompleted,user:t.user,id:t.id}].concat(Object(i.a)(e));case"TOGGLE_TODO":return e.map((function(e){return e._id===t.id&&(e.complete=t.completeCheck,e.dateCompleted=t.completedDateVal),e}));case"DELETE_TODO":return e.filter((function(e){return e._id!==t.id}));case"FETCH_TODOS":return t.todos;case"CLEAR_TODOS":return e.length=0,e;default:return e}}function u(e,t){switch(t.type){case"FETCH_USERS":return t.userList;case"ADD_USER":var c={_id:t._id,username:t.username};return[].concat(Object(i.a)(e),[c]);default:return e}}function b(e,t){return{user:d(e.user,t),todos:j(e.todos,t),userList:u(e.userList,t)}}var l=s.a.createContext({state:{},dispatch:function(){}}),O=c(9),h=c(11),x=c(103),p=c(10),f=c(107),m=c(105),g=c(102),v=c(1);function C(e){var t=e.show,c=e.handleClose,s=Object(a.useContext)(l).dispatch,r=Object(a.useState)(!1),n=Object(o.a)(r,2),i=n[0],d=n[1],j=Object(a.useState)(""),u=Object(o.a)(j,2),b=u[0],O=u[1],h=Object(a.useState)(""),x=Object(o.a)(h,2),C=x[0],w=x[1];var E=Object(p.b)((function(e,t){return{url:"auth/login",method:"post",data:{username:e,password:t}}})),L=Object(o.a)(E,2),y=L[0],_=L[1];return Object(a.useEffect)((function(){y&&!1===y.isLoading&&(y.data||y.error)&&(y.error?(d(!0),alert("failed")):(d(!1),console.log(y.data),s({type:"LOGIN",username:y.data.username,access_token:y.data.access_token})))}),[y]),Object(v.jsx)(f.a,{show:t,onHide:c,children:Object(v.jsxs)(m.a,{onSubmit:function(e){e.preventDefault(),_(C,b),c()},children:[Object(v.jsx)(f.a.Header,{closeButton:!0,children:Object(v.jsx)(f.a.Title,{children:"Login"})}),Object(v.jsxs)(f.a.Body,{children:[Object(v.jsx)(m.a.Label,{htmlFor:"login-username",children:"Username:"}),Object(v.jsx)(m.a.Control,{type:"text",value:C,onChange:function(e){w(e.target.value)},name:"login-username",id:"login-username"}),Object(v.jsx)(m.a.Label,{htmlFor:"login-password",children:"Password:"}),Object(v.jsx)(m.a.Control,{type:"password",value:b,onChange:function(e){O(e.target.value)},name:"login-password",id:"login-password"}),i&&Object(v.jsx)(m.a.Text,{style:{color:"red"},children:"Invalid username or password"})]}),Object(v.jsxs)(f.a.Footer,{children:[Object(v.jsx)(g.a,{variant:"secondary",onClick:c,children:"Cancel"}),Object(v.jsx)(g.a,{variant:"primary",disabled:0===C.length,type:"submit",children:"Login"})]})]})})}function w(){var e=Object(a.useContext)(l),t=e.state,c=e.dispatch,s=t.user;return Object(v.jsxs)("form",{onSubmit:function(e){e.preventDefault(),c({type:"LOGOUT"}),c({type:"CLEAR_TODOS"})},children:["Logged in as: ",Object(v.jsx)("b",{children:s.username}),Object(v.jsx)("input",{type:"submit",value:"Logout"})]})}var E=c(2);function L(e){var t=e.show,c=e.handleClose,s=Object(a.useContext)(l).dispatch,r=Object(a.useState)({username:"",password:"",passwordRepeat:""}),n=Object(o.a)(r,2),i=n[0],d=n[1],j=Object(a.useState)(""),u=Object(o.a)(j,2),b=(u[0],u[1]),O=Object(p.b)((function(e,t){return{url:"auth/register",method:"post",data:{username:e,password:t,passwordConfirmation:t}}})),h=Object(o.a)(O,2),x=h[0],C=h[1];return Object(a.useEffect)((function(){x&&x.data&&(s({type:"REGISTER",username:x.data.username,access_token:x.data.access_token}),s({type:"ADD_USER",username:x.data.username,_id:x.data.id}))}),[x]),Object(a.useEffect)((function(){x&&!1===x.isLoading&&(x.data||x.error)&&(x.error?(console.log(x),b("Registration failed, please try again later."),alert("fail")):(console.log(x),b("Registration successful. You may now login."),alert("success")))}),[x]),Object(v.jsx)(f.a,{show:t,onHide:c,children:Object(v.jsxs)(m.a,{onSubmit:function(e){e.preventDefault(),C(i.username,i.password),c()},children:[Object(v.jsx)(f.a.Header,{closeButton:!0,children:Object(v.jsx)(f.a.Title,{children:"Register"})}),Object(v.jsxs)(f.a.Body,{children:[Object(v.jsx)(m.a.Label,{htmlFor:"register-username",children:"Username:"}),Object(v.jsx)(m.a.Control,{type:"text",value:i.username,onChange:function(e){return d(Object(E.a)(Object(E.a)({},i),{},{username:e.target.value}))},name:"register-username",id:"register-username"}),Object(v.jsx)(m.a.Label,{htmlFor:"register-password",children:"Password:"}),Object(v.jsx)(m.a.Control,{type:"password",name:"register-password",id:"register-password",value:i.password,onChange:function(e){return d(Object(E.a)(Object(E.a)({},i),{},{password:e.target.value}))}}),Object(v.jsx)(m.a.Label,{htmlFor:"register-password-repeat",children:"Repeat password:"}),Object(v.jsx)(m.a.Control,{type:"password",name:"register-password-repeat",id:"register-password-repeat",value:i.passwordRepeat,onChange:function(e){return d(Object(E.a)(Object(E.a)({},i),{},{passwordRepeat:e.target.value}))}})]}),Object(v.jsxs)(f.a.Footer,{children:[Object(v.jsx)(g.a,{variant:"secondary",onClick:c,children:"Cancel"}),Object(v.jsx)(g.a,{variant:"primary",type:"submit",disabled:0===i.username.length||0===i.password.length||i.password!==i.passwordRepeat,children:"Register"})]})]})})}function y(){var e=Object(a.useContext)(l).state,t=Object(a.useState)(!1),c=Object(o.a)(t,2),s=c[0],r=c[1],n=Object(a.useState)(!1),i=Object(o.a)(n,2),d=i[0],j=i[1];return e.user.username?Object(v.jsx)(w,{}):Object(v.jsxs)("div",{className:"justify-content-end",children:[Object(v.jsx)(g.a,{variant:"link",onClick:function(e){return r(!0)},children:"Login"}),Object(v.jsx)(C,{show:s,handleClose:function(){return r(!1)}}),Object(v.jsx)(g.a,{variant:"link",onClick:function(e){return j(!0)},children:"Register"}),Object(v.jsx)(L,{show:d,handleClose:function(){return j(!1)}})]})}var _=c(106),T=function(e){var t=e.text;return Object(v.jsx)(O.a,{href:"/",children:Object(v.jsx)(_.a.Brand,{children:t})})},k=c(104);function D(){var e=Object(a.useContext)(l).state.user;return Object(v.jsx)(_.a,{bg:"light",expand:"lg",children:Object(v.jsxs)(x.a,{children:[Object(v.jsx)(_.a.Brand,{href:"/",children:Object(v.jsx)(T,{text:"My Todo"})}),Object(v.jsx)(_.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(v.jsxs)(_.a.Collapse,{id:"basic-navbar-nav",children:[Object(v.jsx)(k.a.Link,{children:Object(v.jsx)(O.a,{href:"/users/",children:" User List"})}),Object(v.jsx)(k.a,{className:"me-auto",children:e.username&&Object(v.jsx)(k.a.Link,{children:Object(v.jsx)(O.a,{href:"/todo/add",children:"Add New Todo"})})}),Object(v.jsx)(y,{})]})]})})}var S=c(108);function R(e){var t=e.title,c=e.description,s=e.dateCreated,r=e.complete,n=e.dateCompleted,i=e.user,d=(e.id,e._id),j=(e.todoId,e.short),u=void 0!==j&&j,b=Object(a.useContext)(l),h=b.state,f=b.dispatch,m=c;u&&c.length>30&&(m=c.substring(0,30)+"...");var g=Object(p.b)((function(e){return{url:"/todo/".concat(encodeURI(e)),method:"delete",headers:{Authorization:"".concat(h.user.access_token)}}})),C=Object(o.a)(g,2),w=C[0],E=C[1],L=Object(p.b)((function(e,t){var c=e.complete;return{url:"/todo/".concat(encodeURI(t)),method:"patch",headers:{Authorization:"".concat(h.user.access_token)},data:{complete:!c,dateCompleted:F(!c)}}})),y=Object(o.a)(L,2),_=y[0],T=y[1];return Object(a.useEffect)((function(){w&&!1===w.isLoading&&w.data&&f({type:"DELETE_TODO",id:d})}),[w]),Object(a.useEffect)((function(){_&&!1===_.isLoading&&_.data&&f({type:"TOGGLE_TODO",completeCheck:_.data.complete,completedDateVal:_.data.dateCompleted,id:d})}),[_]),Object(v.jsxs)(x.a,{children:[Object(v.jsx)(S.a,{bg:"Light".toLowerCase(),text:"dark",children:Object(v.jsxs)(S.a.Body,{children:[Object(v.jsx)(S.a.Title,{children:Object(v.jsx)(O.a,{href:"/todo/".concat(d),children:t})}),Object(v.jsxs)(S.a.Subtitle,{children:[Object(v.jsxs)("i",{children:["Added by ",Object(v.jsx)("b",{children:i})]}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{})]}),Object(v.jsxs)(S.a.Text,{children:[Object(v.jsx)("div",{children:m}),Object(v.jsx)("br",{}),Object(v.jsx)("div",{children:Object(v.jsxs)("i",{children:["Date Created: ",s]})}),Object(v.jsx)("br",{}),Object(v.jsx)("div",{children:Object(v.jsxs)("i",{children:["Complete: ",Object(v.jsx)("input",{type:"checkbox",checked:r,onClick:function(e){return T({complete:r},d)}})]})}),Object(v.jsx)("br",{}),Object(v.jsx)("div",{children:Object(v.jsxs)("i",{children:["Date Completed: ",n]})}),Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:function(e){return E(d)},children:"Delete"})]}),u&&Object(v.jsx)(O.a,{href:"/todo/".concat(d),children:"View full todo"})]})}),Object(v.jsx)("br",{})]})}function F(e){var t="";if(e){var c=Date.now(),a=new Date(c),s=a.getDate(),r=a.getMonth()+1,n=a.getFullYear();t="".concat(n,"-").concat(r,"-").concat(s)}return t}function A(){var e=Object(a.useContext)(l).state.todos;return Object(v.jsx)("div",{children:e.map((function(e,t){return Object(a.createElement)(R,Object(E.a)(Object(E.a)({},e),{},{key:"Todo-"+t,todoId:t,short:!0}))}))})}function U(){var e=Object(a.useContext)(l),t=e.state,c=e.dispatch,s=Object(p.b)((function(){return{url:"/todo",method:"get",headers:{Authorization:"".concat(t.user.access_token)}}})),r=Object(o.a)(s,2),n=r[0],i=r[1];Object(a.useEffect)((function(){t.user.access_token?i():c({type:"CLEAR_TODOS"})}),[]),Object(a.useEffect)((function(){t.user.access_token?i():c({type:"CLEAR_TODOS"})}),[t.user.access_token]),Object(a.useEffect)((function(){n&&!1===n.isLoading&&n.data&&(console.log(n.data),c({type:"FETCH_TODOS",todos:n.data.todos}))}),[n]);n.data;var d=n.isLoading;return Object(v.jsxs)(v.Fragment,{children:[d&&"Todos loading..."," ",Object(v.jsx)(A,{})]})}function G(){var e=Object(a.useContext)(l),t=e.state,c=e.dispatch,s=t.user,r=Object(O.d)(),n=Object(a.useState)(""),i=Object(o.a)(n,2),d=i[0],j=i[1],u=Object(a.useState)(""),b=Object(o.a)(u,2),h=b[0],x=b[1],f=Object(a.useState)(function(){var e=Date.now(),t=new Date(e),c=t.getDate(),a=t.getMonth()+1,s=t.getFullYear();return"".concat(s,"-").concat(a,"-").concat(c)}()),m=Object(o.a)(f,1)[0],g=Object(a.useState)(!1),C=Object(o.a)(g,1)[0],w=Object(a.useState)(""),E=Object(o.a)(w,1)[0],L=Object(p.b)((function(e){var c=e.title,a=e.description,s=e.dateCreated,r=e.complete,n=e.dateCompleted,o=e.user;return{url:"/todo",method:"post",headers:{Authorization:"".concat(t.user.access_token)},data:{title:c,description:a,dateCreated:s,complete:r,dateCompleted:n,user:o}}})),y=Object(o.a)(L,2),_=y[0],T=y[1];return Object(a.useEffect)((function(){_&&!1===_.isLoading&&_.data&&(c({type:"CREATE_TODO",title:_.data.title,description:_.data.description,dateCreated:_.data.dateCreated,complete:_.data.complete,dateCompleted:_.data.dateCompleted,user:s.username,id:_.data._id}),r.navigate("/todo/".concat(_.data._id)))}),[_]),Object(v.jsxs)("form",{onSubmit:function(e){e.preventDefault(),console.log(s.access_token),T({title:d,description:h,dateCreated:m,complete:C,dateCompleted:E,user:s.username})},children:[Object(v.jsxs)("div",{children:["User: ",Object(v.jsx)("b",{children:s.username})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("label",{htmlFor:"add-title",children:"Title:"}),Object(v.jsx)("input",{type:"text",value:d,onChange:function(e){j(e.target.value)},name:"add-title",id:"add-titile",required:!0})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("label",{htmlFor:"add-description",children:"Description:"}),Object(v.jsx)("textarea",{name:"add-description",value:h,onChange:function(e){x(e.target.value)},id:"add-description"})]}),Object(v.jsxs)("div",{children:["Date Created: ",m]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("label",{htmlFor:"complete-status",children:"Complete:"}),Object(v.jsx)("input",{type:"checkbox",checked:C,id:"complete-status",name:"complete-status"})]}),Object(v.jsxs)("div",{children:["Date Completed:",E]}),Object(v.jsx)("input",{type:"submit",value:"Add",disabled:0===d.length})]})}function H(e){var t=e.id,c=Object(a.useContext)(l).state,s=c.user,r=Object(p.b)((function(){return{url:"/todo/".concat(t),method:"get",headers:{Authorization:"".concat(s.access_token)}}})),n=Object(o.a)(r,2),i=n[0],d=n[1];return Object(a.useEffect)(d,[t]),Object(a.useEffect)(d,[c.todos]),Object(v.jsxs)("div",{children:[i&&i.data?Object(v.jsx)(R,Object(E.a)({},i.data)):"",Object(v.jsx)("div",{children:Object(v.jsx)(O.a,{href:"/",children:"Go Home"})}),Object(v.jsx)("br",{})]})}function I(e){var t=e._id,c=e.username;e.password;return Object(v.jsxs)(x.a,{children:[Object(v.jsx)(S.a,{bg:"Light".toLowerCase(),text:"dark",children:Object(v.jsxs)(S.a.Body,{children:[Object(v.jsxs)(S.a.Title,{children:["User: ",Object(v.jsx)("i",{children:c})]}),Object(v.jsx)(S.a.Text,{children:Object(v.jsxs)(O.a,{href:"/users/".concat(t),children:[" Go to ",c,"'s profile page "]})})]})}),Object(v.jsx)("br",{})]})}function B(){var e=Object(a.useContext)(l),t=e.state;e.dispatch;return Object(v.jsx)("div",{children:t.userList.map((function(e,t){return Object(a.createElement)(I,Object(E.a)(Object(E.a)({},e),{},{key:"User-"+t}))}))})}function z(){var e=Object(a.useContext)(l),t=(e.state,e.dispatch),c=Object(a.useState)(!1),s=Object(o.a)(c,2),r=s[0],n=s[1],i=Object(p.b)((function(){return{url:"/users",method:"get"}})),d=Object(o.a)(i,2),j=d[0],u=d[1];return Object(a.useEffect)(u,[]),Object(a.useEffect)((function(){j&&!1===j.isLoading&&j.data&&(n(!0),t({type:"FETCH_USERS",userList:j.data}))}),[j]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("h3",{children:"Registered Users:"}),Object(v.jsx)("br",{}),r&&Object(v.jsx)(B,{}),Object(v.jsx)("div",{children:Object(v.jsx)(O.a,{href:"/",children:"Go home"})}),Object(v.jsx)("br",{})]})}function N(e){var t=e.id,c=Object(a.useContext)(l),s=(c.state,c.dispatch),r=Object(a.useState)(!1),n=Object(o.a)(r,2),i=n[0],d=n[1],j=Object(p.b)((function(){return{url:"/users/".concat(t),method:"get"}})),u=Object(o.a)(j,2),b=u[0],h=u[1];Object(a.useEffect)((function(){h()}),[]),Object(a.useEffect)((function(){b&&!1===b.isLoading&&b.data&&(console.log(b.data),d(!0),s({type:"FETCH_TODOS",todos:b.data.todos}))}),[b]);b.data,b.isLoading;return Object(v.jsxs)("div",{children:[i&&Object(v.jsx)(A,{}),Object(v.jsx)("div",{children:Object(v.jsx)(O.a,{href:"/users",children:"Go back"})}),Object(v.jsx)("br",{})]})}var M=function(){var e=Object(a.useReducer)(b,{user:{},todos:[],userList:[]}),t=Object(o.a)(e,2),c=t[0],s=t[1],r=Object(h.f)({"/":Object(h.g)({view:Object(v.jsx)(U,{})}),"/users/":Object(h.g)({view:Object(v.jsx)(z,{})}),"/users/:id":Object(h.g)((function(e){return{view:Object(v.jsx)(N,{id:e.params.id})}})),"/todo/add":Object(h.g)({view:Object(v.jsx)(G,{})}),"/todo/:id":Object(h.g)((function(e){return{view:Object(v.jsx)(H,{id:e.params.id})}}))});return Object(v.jsx)("div",{children:Object(v.jsx)(l.Provider,{value:{state:c,dispatch:s},children:Object(v.jsx)(O.b,{routes:r,children:Object(v.jsxs)(x.a,{children:[Object(v.jsx)(D,{}),Object(v.jsx)("hr",{}),Object(v.jsx)(O.c,{})]})})})})},P=c(36),V=c.n(P).a.create({baseURL:"/"});n.a.render(Object(v.jsx)(s.a.StrictMode,{children:Object(v.jsx)(p.a,{value:V,children:Object(v.jsx)(M,{})})}),document.getElementById("root"))}},[[99,1,2]]]);
//# sourceMappingURL=main.77637df0.chunk.js.map